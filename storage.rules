rules_version = '2';

service firebase.storage {
  match /b/{bucket}/o {
    match /user/{userId}/{fileName} {
      allow read, write: if request.auth != null &&
        ((request.auth.uid == userId && resource.name == fileName) ||
         (root.child('user/' + request.auth.uid + '/rol').val() == 'JARL' || root.child('user/' + request.auth.uid + '/rol').val() == 'ERAL') ||
         (root.child('user/' + request.auth.uid + '/rol').val() == 'KARL' &&
          (fileName == 'main_job' || fileName == 'sub_job' || fileName == 'sub_job_2' || fileName == 'craft' || fileName == 'craft_level'))
        );
    }
  }
}
